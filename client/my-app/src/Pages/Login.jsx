import React, { useContext } from 'react'
import { Link } from 'react-router-dom'
import { useState } from 'react';
import axios from 'axios';
import { useNavigate } from 'react-router-dom';
import { AuthContext } from '../context/authContext';


function Login() {
  const [input,setInput]=useState({
    username:"",
    password:"",
  })
  const [err,setErr]=useState(null);

  const handleChange= e =>{
    setInput(prev=>({...prev,[e.target.name]:e.target.value}))
  }
  const navigate=useNavigate();

  const {login} = useContext(AuthContext)
  
  const handleSubmit= async e=>{
      e.preventDefault()
      try {
         await login(input)
        navigate("/")
      } catch (error) {
        setErr(error.response.data);
      }
      
  }
  return (
    <div className='auth'>
      <h1>
        Login
      </h1>
      <form action="">
        <input required  type="text" name="username" placeholder='username' onChange={handleChange}/>
        <input required  type="password" name="password" placeholder='Password' onChange={handleChange}/>
        <button onClick={handleSubmit}>Login</button>
         {err&&<p>{err}</p>}
        <span>Don`t you have an account?<Link to='/Register'>Register</Link></span>
      </form>
    </div>
  )
}

export default Login