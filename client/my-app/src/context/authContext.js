import axios from "axios";
import { useEffect } from "react";
import { createContext, useState } from "react";

export const AuthContext = createContext()


export const AuthContextProvider = ({children})=>{
    const [curentUser,setCurentUser]=useState(JSON.parse(localStorage.getItem("user"))|| null)

    const login = async(input)=>{
       const res = await axios.post("/auth/login",input);
       setCurentUser(res.data)
    };

    const logout = async(input)=>{
        await axios.post("/auth/logout");
        setCurentUser(null)
     };

   useEffect(()=>{
        localStorage.setItem("user",JSON.stringify(curentUser));
   }, [curentUser]);  
   return <AuthContext.Provider value={{curentUser,login,logout}}>{children}</AuthContext.Provider>
}